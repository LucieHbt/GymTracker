---
title: "Programme d'entraînement pour `r input$client_name`"
output:
  pdf_document:
    extra_dependencies: ["booktabs"]
date: "`r format(Sys.Date(), '%d %B %Y')`"
params:
  client_name: NULL
  exercices: NULL
  mouvement: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(knitr)
library(kableExtra)

# Vérifier si les exercices sont bien passés en paramètres
if (is.null(params$exercices)) {
  stop("Les paramètres des exercices sont absents")
}

# Fonction pour afficher les exercices d'une séance sous forme de tableau
afficher_exercices <- function(seance, exercices) {
  cat(paste0("### Séance ", seance, "\n\n"))

  if (length(exercices) == 0) {
    cat("Aucun exercice pour cette séance.\n\n")
    return()
  }

  for (i in seq_along(exercices)) {
    cat("Exercice ", i, "\n")
    cat("Mouvement: ", exercices[[i]]$mouvement, "\n")
    cat("Muscle: ", exercices[[i]]$muscle, "\n")
    cat("Séries: ", exercices[[i]]$series, "\n")
    cat("Répétitions: ", exercices[[i]]$repetitions_min, "-", exercices[[i]]$repetitions_max, "\n\n")
  }
}

```

# Répartition des séances
```{r echo=FALSE, results='asis'}
for (seance in seq_along(params$exercices)) {
  if (names(params$exercices)[seance] != "series_summary_par_semaine") {
    afficher_exercices(seance, params$exercices[[seance]])
  }
}
```

# Répartition du volume d'entraînement par groupe musculaire
```{r echo=FALSE, results='asis'}
if ("series_summary_par_semaine" %in% names(params$exercices)) {
  summary_df <- params$exercices$series_summary_par_semaine
  print(kable(summary_df, format = "latex", booktabs = TRUE, linesep = "") %>%
          kable_styling()
        )
}
```